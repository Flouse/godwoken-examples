(this["webpackJsonp@godwoken-examples/client"]=this["webpackJsonp@godwoken-examples/client"]||[]).push([[0],{27:function(e){e.exports=JSON.parse('{"development_server_url":"http://localhost:6101","production_server_url":"https://your.domain","mode":"development"}')},31:function(e,t,n){"use strict";(function(e){var r=n(34),a=n.n(r),c=n(27);t.a={convertTimestamp:function(e){return"string"===typeof e?new Date(parseInt(e)).toLocaleTimeString():new Date(e).toLocaleTimeString()},hex2dec:function(e){return BigInt(e).toString(10)},dec2hex:function(e){return BigInt(e).toString(16)},shannon2CKB:function(e){return a.a.divide(a.a.BigInt(e),a.a.BigInt(1e8)).toString(10)},CKB2shannon:function(e){return BigInt(e).toString(10)+"00000000"},isObjectInArray:function(e,t){for(var n=0;n<t.length;n++)if(JSON.stringify(t[n])===JSON.stringify(e))return!0;return!1},arrayBufferToBuffer:function(t){for(var n=e.alloc(t.byteLength),r=new Uint8Array(t),a=0;a<n.length;++a)n[a]=r[a];return n},get_env_mode:function(){return"development"===c.mode?"development":"production"}}}).call(this,n(87).Buffer)},318:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),c=n(20),o=n.n(c),s=(n(66),n(60)),i=n(5),u=n(24),d=n(3),l=n.n(d),p=n(7),b=n(12),f=n(9),h=(n(68),n(11)),g=n(19),x=n(21),j=n.n(x),m=n(27),v=n(31);j.a.defaults.withCredentials=!0;var O=function(){function e(){Object(h.a)(this,e),this.base_url=void 0,this.base_url="development"===v.a.get_env_mode()?m.development_server_url:m.production_server_url}return Object(g.a)(e,[{key:"getRollupTypeHash",value:function(){var e=Object(p.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("".concat(this.base_url,"/get_rollup_type_hash"),{params:{}});case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getBalance",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("".concat(this.base_url,"/get_layer2_balance"),{params:{eth_address:t}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deposit",value:function(){var e=Object(p.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get("".concat(this.base_url,"/deposit"),{params:{eth_address:t}});case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"transfer",value:function(){var e=Object(p.a)(l.a.mark((function e(t,n,r,a){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("".concat(this.base_url,"/transfer"),{data:{to_id:t,amount:n,fee:r,eth_address:a}});case 2:return c=e.sent,e.abrupt("return",c.data);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()},{key:"deployContract",value:function(){var e=Object(p.a)(l.a.mark((function e(t,n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("".concat(this.base_url,"/deploy_contract"),{data:{contract_code:t,eth_address:n}});case 2:return r=e.sent,e.abrupt("return",r.data);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"sendL2Transaction",value:function(){var e=Object(p.a)(l.a.mark((function e(t,n,r,a){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("".concat(this.base_url,"/send_l2_tx"),{data:{raw_l2tx:t,signature:n,type:r,l2_script_args:a}});case 2:return c=e.sent,e.abrupt("return",c.data);case 4:case"end":return e.stop()}}),e,this)})));return function(t,n,r,a){return e.apply(this,arguments)}}()}]),e}(),w={page:{maxWidth:"700px",margin:"atuo",textAlign:"center"},content:{width:"100%",marginTop:"20px",textAlign:"left"},main_color:{color:"#3CC68A"},background_color:{color:"#282c34"},wide_card:{padding:"10px",textAlign:"left"},wide_card_title:{color:"#3CC68A",textAlign:"center"},blockquote:{background:"#f9f9f9",borderLeft:"10px solid #3CC68A",margin:"1.5em 10px",padding:"1em 2em",color:"black"},clear_path:{clear:"both"},li:{listStyleType:"none",marginLeft:"0"},ul:{listStyleType:"none",paddingLeft:"0"},status_bar:{width:"100%",padding:"5px",margin:"10px 0px",clear:"both",justifyContent:"center"},status_bar_title:{float:"left",fontSize:"16px",fontWeight:"bolder"},status_bar_btn:{float:"right",textAlign:"center",marginRight:"20px"},modal:{maxWidth:"700px",maxHeight:"80%",overflowY:"scroll",padding:"20px",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto"},paper:{backgroundColor:"gray",border:"2px solid #000",boxShadow:"10px",padding:"10px",width:"100%",outline:"none"},hidden_btn:{width:"100%",border:"0",backgroundColor:"rgb(0,0,0, 0)",height:"0",cursor:"auto"},single_line_code:{background:"white",color:"gray",padding:"2px",borderRadius:"5px"},explain_text:{fontSize:"14px",color:"gray",margin:"20px"},input_wrap:{padding:"2px 5px",marginBottom:"10px",display:"block",background:"white"},input:{width:"100%",outline:"none",fontSize:"14px",border:"0",overflowX:"scroll",verticalAlign:"text-bottom"},describe_img_wrapper:{maxWidth:"100px",margin:"40px auto"},describe_img:{width:"100%",height:"100%",background:"#282c34"},describe_img_footnote:{textAlign:"center",fontSize:"11px"}},y=n(29),_=(n(91),n(2)),k=Object(f.a)(Object(f.a)({},w),{loader:{border:"4px solid rgba(60, 198, 138, 0.2)",borderLeft:"4px solid",animation:"load 1s infinite linear",borderRadius:"50%",width:"25px",height:"25px",margin:"0 auto"},btn:{padding:"0.5rem 1rem",fontSize:"12px",color:"white",borderRadius:"6px",border:"1px solid "+w.main_color.color,outline:"none",backgroundColor:"rgb(255,255,255, 0)",cursor:"pointer"},btndiv:{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"},btn_hover:{padding:"0.5rem 1rem",fontSize:"12px",color:"white",borderRadius:"6px",border:"1px solid "+w.main_color.color,outline:"none",backgroundColor:w.main_color.color,cursor:"pointer"}}),S=function(){return Object(_.jsx)("div",{style:k.loader})};function C(e){var t=Object(r.useState)(0),n=Object(b.a)(t,2),a=n[0],c=(n[1],Object(r.useState)(0)),o=Object(b.a)(c,2),s=o[0],i=(o[1],Object(r.useRef)(null)),u=void 0===e.isLoading,d=Object(r.useState)(!1),h=Object(b.a)(d,2),g=h[0],x=h[1],j=Object(r.useState)(!u&&e.isLoading),m=Object(b.a)(j,2),v=m[0],O=m[1],w=Object(r.useState)(!1),C=Object(b.a)(w,2),A=C[0],L=C[1],B=function(){var t=Object(p.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return u&&O(!0),t.next=3,e.onClick();case 3:u&&O(!1);case 4:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}();Object(r.useEffect)((function(){if(void 0!==e.isLoading&&O(e.isLoading),v&&x(!0),!v&&g){var t=setTimeout((function(){x(!1)}),400);return function(){clearTimeout(t)}}}),[e.isLoading,v,g]);var N=Object(y.b)({opacity:g?1:0}),J=Object(y.b)({opacity:g?0:1}),T=function(){L(!A)},I=a&&s?{width:"".concat(a,"px"),height:"".concat(s,"px")}:{},R=A?k.btn_hover:k.btn,z=Object(f.a)(Object(f.a)({},R),I),W="undefined"===e.custom_style?{}:e.custom_style,q=Object(f.a)(Object(f.a)({},z),W);return Object(_.jsx)("button",{style:q,onClick:B,onMouseEnter:T,onMouseLeave:T,ref:i,children:g?Object(_.jsx)(y.a.div,{style:N,children:Object(_.jsx)(S,{})}):Object(_.jsx)(y.a.div,{style:J,children:e.text})})}var A=n(22),L=(n(93),n(94),Object(f.a)(Object(f.a)({},w),{panel:{},toast:{padding:"10px",fontSize:"14px"}}));function B(){return Object(_.jsx)("div",{children:Object(_.jsx)(A.a,{style:L.panel,toastStyle:L.toast})})}var N=function(e,t){switch(t){case"error":A.b.error(e);break;case"success":A.b.success(e);break;case"warning":A.b.warn(e);break;case"info":A.b.info(e);break;case"dark":A.b.dark(e);break;default:A.b.error(e)}},J=n(336),T=n(337),I=n(335),R=Object(f.a)(Object(f.a)({},w),{header:{minHeight:"300px",margin:"10px"},address:{color:"#a0eec0"},balance:{color:"whitesmoke"},button:{fontSize:"25px",width:"100%",maxWidth:"700px",margin:"10px",padding:"0.7rem 1.2rem"},contract_container:{width:"100%",maxWidth:"700px",margin:"30px auto",textAlign:"left",fontSize:"15px",border:"1px solid gray",color:"gray"},contract_li:{listStyleType:"none"}});var z=function(){var e=Object(r.useRef)(null),t=Object(r.useState)(),n=Object(b.a)(t,2),a=n[0],c=n[1],o=Object(r.useState)("0"),s=Object(b.a)(o,2),i=s[0],d=s[1],f=Object(r.useState)(!1),h=Object(b.a)(f,2),g=h[0],x=h[1],j=Object(r.useState)([]),m=Object(b.a)(j,2),w=m[0],y=m[1],k=Object(r.useState)(),S=Object(b.a)(k,2),A=S[0],L=S[1];Object(r.useEffect)((function(){window.ethereum&&(window.ethereum.request({method:"eth_requestAccounts"}),c(window.ethereum.selectedAddress)),W()}),[]),Object(r.useEffect)((function(){a&&z()}),[a]),window.ethereum.on("accountsChanged",(function(e){c(e[0])}));var z=function(){var e=Object(p.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return");case 2:return t=new O,e.prev=3,e.next=6,t.getBalance(a);case 6:if("ok"===(n=e.sent).status){e.next=9;break}return e.abrupt("return",N("failed to get balance from account. ".concat(JSON.stringify(n.error))));case 9:d(v.a.shannon2CKB(n.data)),e.next=15;break;case 12:e.prev=12,e.t0=e.catch(3),N(JSON.stringify(e.t0));case 15:case"end":return e.stop()}}),e,null,[[3,12]])})));return function(){return e.apply(this,arguments)}}(),W=function(){var e=Object(p.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=new O,e.prev=1,e.next=4,t.getRollupTypeHash();case 4:if("ok"===(n=e.sent).status){e.next=7;break}return e.abrupt("return",N("failed to get rollup type hash. ".concat(JSON.stringify(n.error))));case 7:L(n.data),e.next=13;break;case 10:e.prev=10,e.t0=e.catch(1),N(JSON.stringify(e.t0));case 13:case"end":return e.stop()}}),e,null,[[1,10]])})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(p.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a){e.next=2;break}return e.abrupt("return",N("metamask account not found."));case 2:return t=new O,e.prev=3,e.next=6,t.deposit(a);case 6:n=e.sent,console.log(n),"ok"===n.status?(N("your account id: ".concat(n.data.account_id),"success"),z()):N(JSON.stringify(n.error)),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(3),N(JSON.stringify(e.t0));case 14:case"end":return e.stop()}}),e,null,[[3,11]])})));return function(){return e.apply(this,arguments)}}(),D=function(){var t=Object(p.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",N("input ref not found."));case 2:e.current.click();case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),E=function(){var e=Object(p.a)(l.a.mark((function e(t){var n,r,c,o,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return",N("upload contract binary file first!"));case 2:if(a){e.next=4;break}return e.abrupt("return",N("window.ethereum.selectedAddress not found."));case 4:return n=new O,e.prev=5,e.next=8,n.deployContract(t,window.ethereum.selectedAddress);case 8:if("ok"===(r=e.sent).status){e.next=11;break}return e.abrupt("return",N(JSON.stringify(r)));case 11:return c=r.data,console.log(JSON.stringify(c,null,2)),e.prev=13,e.next=16,window.ethereum.request({method:"personal_sign",params:[c.message,window.ethereum.selectedAddress]});case 16:o=e.sent,e.next=23;break;case 19:return e.prev=19,e.t0=e.catch(13),console.log(e.t0),e.abrupt("return",N("could not finished signing process. \n\n ".concat(JSON.stringify(e.t0))));case 23:return console.log("messageL ".concat(c.message)),console.log("signature: ".concat(o)),e.next=27,n.sendL2Transaction(c.raw_l2tx,o,c.type,c.l2_script_args);case 27:if("ok"===(s=e.sent).status){e.next=31;break}return console.log(s),e.abrupt("return",N(JSON.stringify(s.error)));case 31:console.log(s.data),N("your contract address: ".concat(s.data.contract_address),"success"),y((function(e){return[].concat(Object(u.a)(e),[s.data.contract_address])})),e.next=39;break;case 36:e.prev=36,e.t1=e.catch(5),N(JSON.stringify(e.t1));case 39:case"end":return e.stop()}}),e,null,[[5,36],[13,19]])})));return function(t){return e.apply(this,arguments)}}(),F=function(){var e=Object(p.a)(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t="0x33145551813ccd1abc9b6de9abab432103925399378a779240ff4cd40bf7a242",e.prev=1,e.next=4,window.ethereum.request({method:"personal_sign",params:[t,window.ethereum.selectedAddress]});case 4:n=e.sent,e.next=11;break;case 7:return e.prev=7,e.t0=e.catch(1),console.log(e.t0),e.abrupt("return",N("could not finished signing process. \n\n ".concat(JSON.stringify(e.t0))));case 11:(r=Number.parseInt(n.slice(-2),16))>=27&&(r-=27),n=n.slice(0,-2)+r.toString(16).padStart(2,"0"),console.log("messageL ".concat(t)),console.log("signature: ".concat(n));case 16:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),H=function(){var e=Object(p.a)(l.a.mark((function e(t){var n,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.target.files[0],x(!0),e.next=4,P(n);case 4:if("ok"===(r=e.sent).status){e.next=8;break}return x(!1),e.abrupt("return",N("can not read contract code from file."));case 8:return a=r.data,console.log("reading contract code hex:"),console.log(a),e.next=14,E(a);case 14:x(!1);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),P=function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(e){var n="0x".concat(e.target.result);t({status:"ok",data:n})},r.onerror=function(e){t({status:"failed",error:e})},r.onabort=function(){t({status:"failed",error:"user abort."})},r.readAsBinaryString(e)}))},K="\n  const godwoken_rpc_url = 'http://127.0.0.1:8119';\n  const provider_config =  {\n    godwoken: {\n        rollup_type_hash: \"".concat(A,'",\n        layer2_lock: {\n            code_hash: "0x0000000000000000000000000000000000000000000000000000000000000001",\n            hash_type: "data"\n        }\n    }\n  }\n  const provider = new PolyjuiceHttpProvider(godwoken_rpc_url, provider_config);\n  const web3 = new Web3(provider);\n                  ');return Object(_.jsx)("div",{children:Object(_.jsx)("div",{className:"App",children:Object(_.jsxs)("header",{className:"App-header",children:[Object(_.jsx)(B,{}),Object(_.jsx)(J.a,{container:!0,spacing:3,children:Object(_.jsxs)(J.a,{item:!0,xs:12,style:R.header,children:[Object(_.jsxs)("h3",{children:[" ",a," "]}),Object(_.jsx)("div",{children:Object(_.jsxs)("span",{style:R.balance,children:[i," CKB "]})})]})}),Object(_.jsx)(J.a,{container:!0,spacing:3,children:Object(_.jsx)(J.a,{item:!0,xs:12,children:Object(_.jsx)(C,{text:"test",onClick:F,custom_style:R.button})})}),Object(_.jsx)(J.a,{container:!0,spacing:3,children:Object(_.jsx)(J.a,{item:!0,xs:12,children:Object(_.jsx)(C,{text:"Deposit",onClick:q,custom_style:R.button})})}),Object(_.jsx)(J.a,{container:!0,spacing:3,children:Object(_.jsxs)(J.a,{item:!0,xs:12,children:[Object(_.jsx)(C,{text:"Deploy Contract",isLoading:g,onClick:D,custom_style:R.button}),Object(_.jsx)("input",{type:"file",ref:e,onChange:H,hidden:!0})]})}),Object(_.jsx)("hr",{}),Object(_.jsx)(J.a,{container:!0,spacing:3,children:Object(_.jsxs)(J.a,{item:!0,xs:12,style:R.contract_container,children:["Web3.js init code:",Object(_.jsx)(T.a,{language:"javascript",style:I.a,children:K}),"Contract Address:",Object(_.jsx)(T.a,{language:"javascript",style:I.a,children:w.join("\n")})]})})]})})})};function W(){return Object(_.jsx)(s.a,{children:Object(_.jsx)(i.c,{children:Object(_.jsx)(i.a,{path:"/",children:Object(_.jsx)(z,{})})})})}var q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,338)).then((function(t){var n=t.getCLS,r=t.getFID,a=t.getFCP,c=t.getLCP,o=t.getTTFB;n(e),r(e),a(e),c(e),o(e)}))};o.a.render(Object(_.jsx)(a.a.StrictMode,{children:Object(_.jsx)(W,{})}),document.getElementById("root")),q()},66:function(e,t,n){},68:function(e,t,n){},91:function(e,t,n){},94:function(e,t,n){}},[[318,1,2]]]);
//# sourceMappingURL=main.df3b8af1.chunk.js.map